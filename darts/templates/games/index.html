{% extends "games/layout.html" %}

{% block title %}Games{% endblock %}

{% block head %}
	{{ super() }}
	{% assets output="gen/game-list.css", "stylesheets/game-list.css" %}
		<link href="{{ ASSET_URL }}" rel="stylesheet">
	{% endassets %}
{% endblock %}

{% block body %}

	<div class="games-list">

		<h1>Games</h1>

		<table class="table">
			<tbody>

				{% set num = games|length %}

				{% for game in games %}

					<tr data-href="/games/{{ game["id"] }}/modes/cricket/play/">

						<td class="game-number">
							Game: {{ num }}
							{% set num = num - 1 %}
						</td>

						<td class="game-date">
							{{ game["date"] }}<br />
							{{ game["time"] }}
						</td>

						{% set used = False %}
						{% for team in game["teams"] %}

								<td class="game-team-players">
									{% if team.win %}
										<div class="game-team-result">W</div>
									{% elif team.loss %}
										<div class="game-team-result">L</div>
									{% endif %}

									{% for player in team["players"] %}
										<div class="player">{{ player }}</div>
									{% endfor %}
								</td>

								<td class="game-rounds">
									{% if results.has_key(game.id) and results[game.id].has_key(team.id) %}
										{% set round = 1 %}
										{% for result in results[game.id][team.id] %}
											<span>
												<span class="game-rounds-round">R{{ round }}:</span>
												<span class="game-rounds-score">{{ result.score }}</span>
												<span class="game-rounds-win-loss">
													{% if result.win %}<strong>W</strong>{% endif %}
													{% if result.loss %}L{% endif %}
												</span>
											</span>
											{% set round = round + 1 %}
										{% endfor %}
									{% endif %}
								</td>


							{% if not used %}
								<td class="game-vs">vs</td>
							{% endif %}
							{% set used = True %}

						{% endfor %}

					</tr>

				{% endfor %}

				{% if games|length == 0 %}
					<tr>
						<td colspan="10" class="text-center">No games have been played.</td>
					</tr>
				{% endif %}

			</tbody>
		</table>

	</div>

{% endblock %}

{% block footer %}
	{{ super() }}
	<script>
		$("tr").on("click", function(){
			window.location = $(this).data("href");
		});
	</script>
{% endblock %}
